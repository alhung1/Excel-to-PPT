@echo off
chcp 65001 >nul
title Excel to PPT Generator

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘         ğŸ“Š Excel to PPT Generator v4.0                  â•‘
echo â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
echo â•‘  å•Ÿå‹•ä¸­... è«‹ç¨å€™                                        â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

:: åˆ‡æ›åˆ°å°ˆæ¡ˆç›®éŒ„
cd /d "%~dp0"

:: æª¢æŸ¥è™›æ“¬ç’°å¢ƒæ˜¯å¦å­˜åœ¨
if not exist "venv\Scripts\activate.bat" (
    echo [éŒ¯èª¤] æ‰¾ä¸åˆ°è™›æ“¬ç’°å¢ƒï¼Œè«‹å…ˆåŸ·è¡Œ setup.bat å®‰è£
    pause
    exit /b 1
)

:: å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
call venv\Scripts\activate.bat

:: æª¢æŸ¥ä¾è³´å¥—ä»¶
python -c "import fastapi" 2>nul
if errorlevel 1 (
    echo [è³‡è¨Š] æ­£åœ¨å®‰è£ä¾è³´å¥—ä»¶...
    pip install -r requirements.txt -q
)

echo.
echo âœ“ ç’°å¢ƒæº–å‚™å®Œæˆ
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   ğŸŒ æœå‹™å•Ÿå‹•ä¸­...
echo   ğŸ“ ç¶²å€: http://localhost:8000
echo   ğŸ›‘ é—œé–‰: æŒ‰ Ctrl+C æˆ–ç›´æ¥é—œé–‰æ­¤è¦–çª—
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

:: å»¶é² 2 ç§’å¾Œé–‹å•Ÿç€è¦½å™¨
start "" cmd /c "timeout /t 2 /nobreak >nul && start http://localhost:8000"

:: å•Ÿå‹• FastAPI æœå‹™
python -m uvicorn app.main:app --host 127.0.0.1 --port 8000

:: å¦‚æœæœå‹™çµæŸï¼Œæš«åœé¡¯ç¤º
echo.
echo æœå‹™å·²åœæ­¢
pause

